% !TEX root = ../main.tex
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\begin{frame}\begin{center}
		\LARGE\textit{Mathematical formulation}
\end{center}\end{frame}
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\begin{frame}
\textbf{Policy Evaluation}\vspace{0.3cm}
\begin{align*}
v^\pi_t(s) = \E^\pi_{s}\left[ \sum^T_{\tau=t} \delta^{\tau - t}   r_\tau(X_\tau, d_\tau(X_\tau)) \right]\\
\end{align*}

Inductive Scheme
\begin{align*}
v^\pi_t(s) = r_t(s, d_t(s)) + \delta\E^\pi_{s} \left[v^\pi_{t + 1}(X_{t + 1})\right]
\end{align*}
\end{frame}
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\begin{frame}
\textbf{Optimality Equations}\vspace{0.3cm}
\begin{align*}\label{MPD Optimality}
v^{\pi^*}_t(s) = \max_{a \in A}\bigg\{ r_t(s, a) + \delta \E^p_{s} \left[v^{\pi^*}_{t + 1}(X_{t + 1})\right] \bigg\}.
\end{align*}
\end{frame}
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\begin{frame}
\textbf{Backward Induction Algorithm for MDP}\vspace{0.5cm}

\begin{algorithmic}\small
\For{$t = T, \hdots, 1$}
    \If{t == T}
        \State $v^{\pi^*}_T(s) = \underset{a \in A}{\max}\bigg\{ r_T(s, a) \bigg\}\qquad \forall\quad s\in S$
    \Else
        \State Compute $v^{\pi^*}_t(s)$ for each $s\in S$ by
        \State $\qquad v^{\pi^*}_t(s) = \underset{a \in A}{\max}\bigg\{ r_t(s, a) + \delta\E^p_{s} \left[v^{\pi^*}_{t + 1}(X_{t + 1})\right] \bigg\}$
        \State and set
        \State $\qquad d^{\pi^*}_t(s) = \underset{a \in A}{\argmax}\bigg\{ r_t(s, a) + \delta\E^p_{s} \left[v^{\pi^*}_{t + 1}(X_{t + 1})\right] \bigg\}$
    \EndIf
\EndFor
\end{algorithmic}
\end{frame}
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
