%!TEX root = ../main.tex
%-------------------------------------------------------------------------------
\subsection{Calibration procedure}
%-------------------------------------------------------------------------------
EKW models are calibrated to data on observed individual decisions and experiences under the hypothesis that the individual's behavior is generated from the solution to the model. The goal is to back out information on reward functions, preference parameters, and transition probabilities. This requires the full parameterization $\theta$ of the model.\\

\noindent Economists have access to information for $i = 1, \hdots, N$ individuals in each time period $t$. For every observation $(i, t)$ in the data, we observe action $a_{it}$ and a subset $x_{it}$ of the state $s_{it}$. Therefore, from an economist's point of view, we need to distinguish between two types of state variables $s_{it} = (x_{it}, \epsilon_{it})$. At time $t$, the economist and individual both $i$ observe $x_{it}$ while $\epsilon_{it}$ is only observed by the individual. In summary, the data $\mathcal{D}$ has the following structure:
%
\begin{align*}
  \mathcal{D} = \{a_{it}, x_{it}, r_{it}: i = 1, \hdots, N; t = 1, \hdots, T_i\},
\end{align*}
where $T_i$ is the number of observations for which we observe individual $i$.\\

\noindent Numerous calibration procedures exist that are tailored to different settings \citep{Davidson.2003, Gourieroux.1996}. We briefly outline likelihood-based and simulation-based calibration. Whatever the calibration criterion, to evaluate it for every candidate parameterization of the model, it is necessary to solve the model again to construct the optimal policy $\pi^*$.

\paragraph{Likelihood-based} The individual chooses the alternative with the highest total value $a_t^{\pi^*}(s_t)$ which is determined by the complete state $s_t$. However, economists only observe the subset $x_t$. Given parametric assumptions about the distribution of $\epsilon_{it}$, we can determine the probability $p_{it}(a_{it}, r_{it} \mid x_{it}, \theta)$ of individual $i$ at time $t$ in $x_{it}$ choosing $a_{it}$ and receiving $r_{it}$.\\

\noindent The likelihood function $\mathcal{L}(\theta\mid\mathcal{D})$ captures the probability of the observed data as a function of $\theta$. The task is to choose $\theta$ as to maximize it:
%
\begin{align*}
  \hat{\theta} \equiv \argmax_{\theta \in \Theta}  \underbrace{\prod^N_{i= 1} \prod^{T_i}_{t= 1}\, p_{it}(a_{it}, r_{it} \mid x_{it}, \theta)}_{\mathcal{L}(\theta\mid\mathcal{D})}.
\end{align*}

\paragraph{Simulation-based}

Simulation-based calibration involves the simulation of data using the parameter vector $\theta$. The model is simulated by drawing observations for individuals at one or multiple points in time, generating a series of shocks and wage measurement errors for each individual $i$ in each period $t$, and then solving the model based on the given inputs and $\theta$. Simulation-based calibration then targets the parameter specification that produces the closest simulated match to the observed data.\\

\noindent A prevalent method for matching simulated and observed data is the Method of Simulated Moments (MSM) first developed by \citet{McFadden.1989}. The MSM calibrates parameters by minimizing the weighted squared difference between observed and simulated model moments. The objective is given by

\begin{align*}
	\hat{\theta} \equiv \argmin_{\theta in \Theta} (M(x) - M_S(\tilde{x}| \theta))' W (M(x) - M_S(\tilde{x}|\theta))
\end{align*}

where $M(x)$ denotes the $m \times 1$ vector of moments computed from the observed data $x$
and $M_S(\tilde{x}| \theta)$ denotes the vector of moments computed from $S$ simulations $\tilde{x} = \{\tilde{x}_1, ... , \tilde{x}_S\}$ of the data based on $\theta$. $W$ denotes a $m \times m$ weighting matrix which impacts how each moment is weighted in the minimization problem.