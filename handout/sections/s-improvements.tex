%!TEX root = ../main.tex
%-------------------------------------------------------------------------------
\section{Improvements}\label{Computation}
%-------------------------------------------------------------------------------
The implementation of EKW models poses several computational challenges. Among them numerical integration, global optimization, function approximation, and efficient parallelization. We now describe some of our efforts to align \verb+respy+ and \verb+estimagic+ with the state-of-the-art in computational methods. We have concluded our own preparatory work and actively seek input from domain experts for further improvements and subsequent joint publication.
%-------------------------------------------------------------------------------
\subsection{Numerical integration}
%-------------------------------------------------------------------------------
In \citet{Gabler.2020a} we draw on the extensive literature in applied math on numerical integration \citep{Davis.2007,Gerstner.1998}.\\

\noindent To clarify the structure of the integral determining the future value of a state, it is useful to consider the optimality equation in a generic time period $t$. Let $v^{\pi}_{t}(s_t, a_t)$ denote the action-specific value function of choosing action $a$ in state $s$ while continuing with the optimal policy going forward.
%
\begin{align*}
v^{\pi}_{t}(s_t, a_t) & = u(s_t, a_t) + \delta\,\E_{s_t} \left[\left.v^{\pi^*}_{t + 1}(s_{t + 1})\,\right\vert\,\mathcal{I}_t\,\right] \\
& =  u(s_t, a_t) + \delta\, \int_S v^{\pi^*}_{t + 1}(s_{t + 1})\, \diff p_t(a_t, s_t)\\
& =  u(s_t, a_t) + \delta\, \underbrace{\int_S \max_{a \in A}\bigg\{v^\pi_{t + 1}(s_{t + 1}, a_{t + 1})\bigg\}\diff p_t(a_t, s_t)}_{\mathcal{I}(a_{t + 1})}.
\end{align*}

\noindent We need to solve the integral $\mathcal{I}(a_{t + 1})$ millions of times during the backward induction procedure. The current practice is to implement a random Monte Carlo integration which introduces considerable numerical error and computational instabilities \citep{Judd.2011}.\\

\noindent Let's consider an atemporal version of the typical integral from \citet{Keane.1994}. As outlined earlier, individuals can choose among four alternatives. Each of the alternative-specific rewards is in part determined by a random continuous state variable that follows a normal distribution. The transition of all other state variables is deterministic. This results in a four-dimensional integral of the following form:
%
\begin{align*}
   \int_{\epsilon}\, \max_{a\in A} \bigg\{v_{t + 1}^\pi(x_{t + 1}, \epsilon, a)\}\bigg\} \phi_{\mu, \Sigma}(\epsilon) \diff\epsilon.
\end{align*}

\noindent where $\epsilon = (\epsilon_1, \dots, \epsilon_4) \sim \mathcal{N}(\mu, \Sigma)\,$ follows a multivariate normal distribution with mean $\mu \in \mathbb{R}^{4}$, covariance matrix $ \Sigma \in \mathbb{R}^{4 \times 4}$, and probability density function $\phi_{\mu, \Sigma}$.
%-------------------------------------------------------------------------------
\subsection{Global optimization}
%-------------------------------------------------------------------------------
In \citet{Gabler.2020}, we draw on the specialized literature on global optimization to assess and improve the reliability of the model calibration \citep{Locatelli.2013,Nocedal.2006}.\\

\noindent We conduct a benchmarking exercise using \citet{Keane.1994,Keane.1997} as a well-known and empirically-grounded test case. Depending on the calibration procedure, particular challenges arise. For example, likelihood-based estimation requires smoothing of the choice probabilities, while simulation-based calibration involves noisy function optimization.
